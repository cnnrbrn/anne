import{a as i}from"./authGuard-CPtELXvo.js";import{s as l}from"./logout-QhuYu8CF.js";import{h as d,f as m}from"./nav-BI90erGG.js";import{h as c}from"./headers-B7o3POYX.js";import{a as u}from"./read-DJUjkWj8.js";async function g(t,{title:n,body:e,tags:o,media:s}){t=new URLSearchParams(window.location.search).get("id");try{const a=await fetch(`${d}/${t}`,{method:"PUT",headers:c(),body:JSON.stringify({title:n,body:e,tags:o,media:s})});if(!a.ok)alert("Failed to update post");else return alert("Post successfully updated"),window.location.href=`/post/?id=${t}`,await a.json()}catch(a){console.error("Failed to update the post:",a)}}async function p(t,n){t.preventDefault();const e=new FormData(t.target),o=e.get("image"),s=e.get("alt"),a={title:e.get("postTitle"),body:e.get("postText"),tags:e.get("tags")?e.get("tags").split(", ").map(r=>r.trim()):[],media:o||s?{url:o,alt:s}:null};try{await g(n,a)}catch(r){console.error("Failed to update post:",r),alert("There was an error updating your post. Please try again.")}}async function f(){const t=await u();t&&(document.getElementById("postTitle").value=t.title||"",document.getElementById("postText").value=t.body||"",document.getElementById("tags").value=t.tags?t.tags.join(", "):"",document.getElementById("imageUrl").value=t.media?.url||"",document.getElementById("imageAlt").value=t.media?.alt||"")}const y=document.forms.editPost;y.addEventListener("submit",p);m();l();i();await f();
